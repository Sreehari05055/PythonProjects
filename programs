import math
import sys
if __name__ == '__main__':
    print("Welcome To the SA's finance calculator")
    print("================================")
    def expenses():
        while True:
            num1 = input("Please input your Monthly income after taxes:")
            try:
                num1 = float(num1)
            except:
                print("Please Use numeric digits! ")
                continue
            if num1 <= 0:
                print("Please enter a positive amount!")
                continue
            else:
                break
        while True:
                    question = input("What is your compulsory monthly expenses:")
                    try:
                        question = float(question)
                    except:
                        print("Please use numeric digits !")
                        continue
                    if question <= 0:
                        print("Please enter a positive amount! ")
                    elif question >= num1:
                        print("This is practically impossible")
                        continue
                    else:
                        break
        while True:
                    question_1 = input("What would be an approximate of non-compulsory expenses in a month:")
                    try:
                        question_1 = float(question_1)
                    except:
                        print("Please use numeric digits! ")
                        continue
                    if question_1 <= 0:
                            print("Please enter a positive amount!")
                            continue
                    else:
                        remaining_Money = num1 - question - question_1
                        if remaining_Money <= 0:
                            print("Please try again")
                            continue
                        break
        while True:    
                    question_2 = input("Do you want to buy/own any possessions in the near future(Yes/No): ").lower()
                    if len(question_2) == 0:
                        continue
                    elif question_2 != "yes" and question_2 != "no":
                        continue
                    elif question_2 == "no":
                        print("Thank you for your time! ")
                        break
                    else:
                        break
        while True:            
                    question_3 = input("Have you taken a Loan from a bank to buy the possesion and still found it insuffient? (Yes/No): ").lower()
                    if len(question_3) == 0:
                        continue
                    elif question_3 != "yes" and question_3 != "no":
                        continue
                    else:
                        if question_2 == "yes" and question_3 == "no":
                            while True:
                                question_4 = input("How much would the possession cost: ")
                                try:
                                    question_4 = float(question_4)
                                except:
                                    print("Please enter numeric digits! ")
                                    continue
                                if question_4 <= 0:
                                    print("Please enter a positive number! ")   
                                    continue
                                else:
                                    question_5 = input("How much are you willing to save every month: ")
                                    try:
                                        question_5 = float(question_5)
                                    except:
                                        print("Please enter numeric digits! ")
                                        continue
                                    if question_5 > remaining_Money:
                                        print("Invalid amount stated")
                                        continue
                                    elif question_5 <= 0:
                                        print("Please enter a positive number! ")
                                    else:
                                        division = question_4 // question_5
                                        converting_months =  division //  12
                                        print("It would take " + str(converting_months)+" years or "+ str(division) +" months if you were to make the purchase.")
                                        if question_4 % question_5 != 0:
                                            detail = input("Do you want to know the exact time it would take?(Yes/No) ").lower()
                                            if detail == "yes":
                                                division_again = question_4 / question_5 
                                                print("It would take exactly " + str(division_again) +" months if you intended to make the purchase.")
                                                break
                                            else:
                                                print("Thank you for your time.")
                                                break
                                        else:
                                            break                        
                        elif question_2 == "yes" and question_3 == "yes":
                                        while True:
                                            cost = input("How much would the possession cost: ")
                                            try:
                                                cost = float(cost)
                                            except:
                                                print("Please enter numeric digits! ")
                                                continue
                                            if cost <= 0:
                                                print("Please enter a positive number! ")   
                                                continue
                                            else:
                                                def jack(loan_amount,loan_interest,loan_Term):
                                                    to_months = loan_Term * 12
                                                    monthly_interest = ((loan_interest)/100)/12
                                                    loan_payment = (monthly_interest*loan_amount*((1+monthly_interest)**to_months))/(((1+monthly_interest)**to_months)-1)
                                                    return loan_payment
                                                break
                                        while True:
                                                loan_interest = input("Enter the annual interest rate:")
                                                try:
                                                    loan_interest = float(loan_interest)
                                                except:
                                                    print("Please enter numeric digits! ")
                                                    continue
                                                if loan_interest <= 0:
                                                    print("Please enter a positive number! ")   
                                                    continue
                                                else:
                                                    break
                                        while True:
                                                loan_term = int(input("Enter the term period in years:"))
                                                try:
                                                    loan_term = float(loan_term)
                                                except:
                                                    print("Please enter numeric digits! ")
                                                    continue
                                                if loan_term <= 0:
                                                    print("Please enter a positive number! ")   
                                                    continue
                                                else:
                                                    break
                                        while True:
                                                loan_amount = float(input("Enter the amount withdrawn from the bank:"))
                                                try:
                                                    loan_amount = float(loan_amount)
                                                except:
                                                    print("Please enter numeric digits! ")
                                                    continue
                                                if loan_amount <= 0:
                                                    print("Please enter a positive number! ")   
                                                    continue
                                                else:
                                                    if loan_amount >= cost:
                                                        print("You could already buy the possession")
                                                        do_you = input("Do you still want to calculate your loan repayment value?(Yes/No) ").lower()
                                                        if do_you == "yes":
                                                            readable = float(format(jack(loan_amount,loan_interest,loan_term)))
                                                            print("You would have to pay about £" + str(round(readable)) + " every month for " + str(loan_term) + " years to clear the loan")
                                                            break
                                                        
                                                        else:
                                                            if do_you == "no":
                                                                print("Thank you for your time! ")
                                                                break
                                                            else:
                                                                print("Please enter(Yes/No)")
                                                                continue
                                                    else:
                                                        readable = float(format(jack(loan_amount,loan_interest,loan_term)))
                                                        print("You would have to pay about £" + str(round(readable)) + " every month to clear the loan")
                                                        question_6 = input("Are you willing to save apart from the loan(Yes/No):").lower()
                                                        if question_6 == "yes":
                                                            while True:
                                                                question_7 = input("How much are you willing to save every month:")
                                                                remaining_2 = num1 - question - question_1 - readable
                                                                try:
                                                                    question_7 = float(question_7)
                                                                except:
                                                                    print("Please enter numeric digits! ")
                                                                    continue            
                                                                if question_7 > remaining_2:
                                                                    print("Invalid amount stated")
                                                                    continue
                                                                elif question_7 <= 0:
                                                                    print("Please enter a positive number! ")
                                                                    continue
                                                                else: 
                                                                    remaining = cost - loan_amount
                                                                    amount = remaining / question_7
                                                                    yearly_amount = amount / 12
                                                                    print("If you were to save money and use the entire withdrawn money it would take " + str(amount) + " months / "+ str(round(yearly_amount)) +" years to make the purchase.")
                                                                    break   
                                                        else:
                                                            print("Thank you for your time! ")
                                                break            
                        else:
                            print("Thank you for your time! ")   
                    break 
    expenses()
                                    
                    
                                    